問題9-2オンラインブックストアのシステムでは、毎日深夜0時に自動的に次の統計処理が実行されます。
利用している DBMS は4つの分離レベルすべてをサポートしており、ロックエスカレーションは発生しないものとします。

01  BEGIN;
02  SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
03  UPDATE 受注統計 -- (1)
04    SET 統計値 = (SELECT COUNT(*) FROM 受注)
05    WHERE 項目名 = '注文回数';
06  UPDATE 受注統計 -- (2)
07    SET 統計値 = (SELECT AVG(注文数) FROM 受注)
08    WHERE 項目名 = '平均受注数';
09  UPDATE 受注統計 -- (3)
10    SET 統計値 = 20240413 -- 本日の日付を整数表記したもの
11    WHERE 項目名 = '統計実施日';
12  COMMIT;

受注統計テーブル
| 列名  | データ型        | 備考    |
| --- | ----------- | ----- |
| 項目名 | VARCHAR(10) | 統計の種類 |
| 統計値 | INT         | 統計の値  |

設問
以上の SQL 文とテーブルに基づき、次の各項目について、正しければ〇を、誤っていれば✕を付けてください。
ア. この SQL 文は 1 つのトランザクションとして実行される。
→ 〇

イ. (2) の SQL 文の実行でエラーが発生した場合、(1) までの処理が確定される。
→ ×

ウ. 受注統計テーブルに主キーが 1 つも存在しないと、ロールバックが発生する。
→ ×

エ. 最後の1行を ROLLBACK;に書き換えると、受注統計テーブルのデータは更新されなくなる。
→ 〇

オ. (1) の SQL 文では副問い合わせを使っているので、受注の回数を常に正確に取得できる。
→ 〇　正解：×

カ. (1) の SQL 文の実行と、(2) の SQL 文の実行の間に書籍の注文が入ると、
受注統計テーブルの「注文回数」と「平均注文数」を掛け算しても、合計注文数と一致しなくなってしまう恐れがある。
→ 〇

キ. この SQL 文が実行されている間、受注統計テーブルにはロックがかかり、
ほかのトランザクションからは一切アクセスできなくなる。
→ 〇 正解：×

ク. 統計処理の実行中に、READ UNCOMMITTED 分離レベルで
`SELECT * FROM 受注統計` を実行すると、統計実施日のみ、古い情報が取得できてしまう可能性がある。
→ 〇

ケ. 2行目で選択する分離レベルは、SERIALIZABLE にしたほうが DBMS 全体のパフォーマンスは向上することが多い。
→ ×