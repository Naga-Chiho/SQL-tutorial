牛を個体識別番号で管理している個体識別テーブルがあります。このテーブルについて、次の設問1〜3で指示されたSQL文を作成してください。

個体識別テーブル
| 列名     | データ型        | 備考                              |
| ------ | ----------- | ------------------------------- |
| 個体識別番号 | CHAR(4)     | 牛を一意に管理する番号                     |
| 出生日    | DATE        | その牛が出生した日付                      |
| 性別コード  | CHAR(1)     | 牛の性別を表すコード 1:雄 2:雌              |
| 母牛番号   | CHAR(4)     | 母牛の個体識別番号                       |
| 品種コード  | CHAR(2)     | 牛の品種を表すコード 01:乳用種 02:肉用種 03:交雑種 |
| 飼育県    | VARCHAR(10) | 牛を飼育している都道府県名                   |

1.
飼育県別に飼育頭数を集計し、その結果を次の頭数集計テーブルに登録する。

頭数集計テーブル
| 列名  | データ型        | 備考      |
| --- | ----------- | ------------- |
| 飼育県 | VARCHAR(20) | 牛を飼育している都道府県名 |
| 頭数  | INTEGER     | 飼育している牛の数     |

【メモ】
飼育県別に飼育頭数を集計 → 飼育している牛の数を数える 
個体識別番号を使おう！ → COUNT(個体識別番号) 

飼育県別ごとに → GROUP BY 飼育県  

結果を「頭数集計テーブル」に保存する → INSERT INTO 頭数集計 

【回答】
INSERT INTO 頭数集計
SELECT 飼育県, COUNT(個体識別番号)
FROM 個体識別
GROUP BY 飼育県

2.
1で作成した頭数集計テーブルで、飼育頭数の多いほうから3つの都道府県で飼育されている牛のデータを、個体識別テーブルより抽出する。
抽出する項目は、都道府県名、個体識別番号、雌雄とする。
ただし、雌雄はコードではなく「雄」「雌」の日本語表記とする。

都道府県を抽出 → 飼育県を都道府県にする 
SELECT 都道府県名, 個体識別番号, 雌雄
CASE で「1=雄」「2=雌」に変換する！

飼育頭数の多いほうから3つの都道府県 → もっかいSELECTして、上から3頭を取り出しとけばええやん～
多い方からなので、降順でとりだす


SELECT 飼育県 AS 都道府県, 個体識別番号,
CASE 雌雄コード WHEN '1' THEN '雄'
               WHEN '2' THEN '雌' END AS 雌雄
FROM 個体識別
WHERE 飼育県 IN (SELECT 飼育県 FROM 頭数集計
                 ORDER BY 頭数 DESC
                 OFFSET 0 ROWS LIMIT 3)

3.
個体識別テーブルには母牛についてもデータ登録されており、母牛が乳用種である牛の一覧を個体識別テーブルより抽出したい。
抽出する項目は、個体識別番号、品種、出生日、母牛番号とする。
ただし、品種はコードではなく「乳用種」「肉用種」「交雑種」の日本語表記とする。

【メモ】
SELECT → 個体識別番号、品種、出生日、母牛番号
品種コードは CASE で日本語にしないといけない！

母牛が乳用種である
→もういっこのSELECTで「乳用種（品種コード='01'）の牛の個体番号」を取るようにしよう

SELECT 個体識別番号
CASE 品種コード WHEN '01' THEN '乳用種'
               WHEN '02' THEN '肉用種'
               WHEN '03' THEN '交雑種' END AS 品種,
     出生日, 母牛番号
FROM 個体識別
WHERE 母牛番号 IN (SELECT 個体識別番号 FROM 個体識別
                   WHERE 品種コード = '01')

